metadata:
  title: 07_multi_agent_orchestrator
  source: .cursor/prompts/07_multi_agent_orchestrator.md
  source_type: markdown
  converted_by: Universal Document to YAML Converter
  format_version: "2.0"
content:
  sections[44]:
    - title: # Multi-Agent Orchestration Template
      content[2]: "**Context**: Use this template for coordinating complex, multi-step workflows that require multiple specialized agents working together.","---"
      subsections[0]:
    - title: ## Task Overview
      content[3]: "**Complex Task**: [DESCRIBE THE OVERALL OBJECTIVE]",This task requires coordination between multiple specialized agents.,"---"
      subsections[0]:
    - title: ## Agent Definitions
      content[0]:
      subsections[0]:
    - title: ### Available Agents
      content[8]: | Agent | Role | Tools | Scope |,|-------|------|-------|-------|,"| **PlannerAgent** | Breaks down tasks, creates execution plans | Planning tools | High-level strategy |","| **ResearcherAgent** | Gathers information from sources | Web search, RAG, Docs | Information retrieval |","| **CoderAgent** | Writes and modifies code | File tools, Terminal | Implementation |","| **TesterAgent** | Creates and runs tests | Test runner, Coverage | Validation |",| **ReviewerAgent** | Reviews for quality and correctness | Code analysis | Quality assurance |,"---"
      subsections[0]:
    - title: ## Orchestration Rules
      content[0]:
      subsections[0]:
    - title: ### Routing Logic
      content[0]:
      subsections[0]:
    - title: 1. Analyze user request and classify intent
      content[0]:
      subsections[0]:
    - title: 2. Route to appropriate specialist agent
      content[0]:
      subsections[0]:
    - title: 3. Keep subsequent turns with same agent until topic shifts
      content[0]:
      subsections[0]:
    - title: 4. Log every routing decision for debugging
      content[0]:
      subsections[0]:
    - title: ### State Management
      content[4]: "- Maintain shared state across agent handoffs","- Use session-specific state (keyed by session/user)","- Checkpoint at important milestones","- Each agent reads from and writes to shared state"
      subsections[0]:
    - title: ### Verification Layers
      content[3]: "- Before finalizing, invoke ReviewerAgent to validate","- On validation failure, route back to original agent for correction","- Maximum 3 correction attempts before escalation"
      subsections[0]:
    - title: ### Error Handling
      content[5]: "- On agent error: retry once, then try alternative approach","- On timeout: abort current step, log, and escalate","- On validation failure: route to correction flow","- Maximum 10 steps per workflow to prevent runaway loops","---"
      subsections[0]:
    - title: ## Workflow Template
      content[1]: ```yaml
      subsections[0]:
    - title: "workflow:"
      content[0]:
      subsections[0]:
    - title: "name: \"[WORKFLOW_NAME]\""
      content[0]:
      subsections[0]:
    - title: "steps:"
      content[1]: "- step: \"Plan\""
      subsections[0]:
    - title: "agent: PlannerAgent"
      content[0]:
      subsections[0]:
    - title: "action: \"Analyze request and create execution plan\""
      content[0]:
      subsections[0]:
    - title: "output: execution_plan"
      content[1]: "- step: \"Research\""
      subsections[0]:
    - title: "agent: ResearcherAgent"
      content[0]:
      subsections[0]:
    - title: "action: \"Gather required information\""
      content[0]:
      subsections[0]:
    - title: "input: execution_plan"
      content[0]:
      subsections[0]:
    - title: "output: research_results"
      content[1]: "- step: \"Implement\""
      subsections[0]:
    - title: "agent: CoderAgent"
      content[0]:
      subsections[0]:
    - title: "action: \"Write code according to plan\""
      content[0]:
      subsections[0]:
    - title: "input: [execution_plan, research_results]"
      content[0]:
      subsections[0]:
    - title: "output: implementation"
      content[1]: "- step: \"Test\""
      subsections[0]:
    - title: "agent: TesterAgent"
      content[0]:
      subsections[0]:
    - title: "action: \"Create and run tests\""
      content[0]:
      subsections[0]:
    - title: "input: implementation"
      content[0]:
      subsections[0]:
    - title: "output: test_results"
      content[1]: "- step: \"Review\""
      subsections[0]:
    - title: "agent: ReviewerAgent"
      content[0]:
      subsections[0]:
    - title: "action: \"Review implementation quality\""
      content[0]:
      subsections[0]:
    - title: "input: [implementation, test_results]"
      content[0]:
      subsections[0]:
    - title: "output: review_verdict"
      content[1]: "- step: \"Finalize\""
      subsections[0]:
    - title: "condition: \"review_verdict == 'pass'\""
      content[0]:
      subsections[0]:
    - title: "action: \"Aggregate results and deliver\""
      content[0]:
      subsections[0]:
    - title: "fallback: \"Route to correction flow\""
      content[2]: ```,"---"
      subsections[0]:
    - title: ## Coordination Protocol
      content[0]:
      subsections[0]:
    - title: ### Message Format
      content[17]: ```json,"{","\"from_agent\": \"AgentName\",","\"to_agent\": \"AgentName | Orchestrator\",","\"message_type\": \"request | response | error\",","\"content\": {","\"action\": \"what was done\",","\"result\": \"output data\",","\"status\": \"success | failure | needs_input\"","},","\"context\": {","\"step_number\": 1,","\"session_id\": \"...\",","\"trace_id\": \"...\"","}","}",```
      subsections[0]:
    - title: ### Handoff Rules
      content[5]: "- Agent completes its task fully before handoff","- Pass only necessary context to next agent","- Include validation status in handoff","- Orchestrator maintains global view","---"
      subsections[0]:
    - title: ## Safety Controls
      content[6]: "- [ ] Each agent has limited, well-defined tools","- [ ] No agent can execute high-risk actions without approval","- [ ] Maximum step limit enforced","- [ ] All agent actions logged for audit","- [ ] Human escalation path defined","---"
      subsections[0]:
    - title: ## Success Criteria
      content[5]: "- [ ] All subtasks completed successfully","- [ ] Final output meets all requirements","- [ ] All agent outputs validated","- [ ] Complete audit trail maintained","- [ ] No security violations"
      subsections[0]:
  raw_text: "# Multi-Agent Orchestration Template\n\n**Context**: Use this template for coordinating complex, multi-step workflows that require multiple specialized agents working together.\n\n---\n\n## Task Overview\n\n**Complex Task**: [DESCRIBE THE OVERALL OBJECTIVE]\n\nThis task requires coordination between multiple specialized agents.\n\n---\n\n## Agent Definitions\n\n### Available Agents\n\n| Agent | Role | Tools | Scope |\n|-------|------|-------|-------|\n| **PlannerAgent** | Breaks down tasks, creates execution plans | Planning tools | High-level strategy |\n| **ResearcherAgent** | Gathers information from sources | Web search, RAG, Docs | Information retrieval |\n| **CoderAgent** | Writes and modifies code | File tools, Terminal | Implementation |\n| **TesterAgent** | Creates and runs tests | Test runner, Coverage | Validation |\n| **ReviewerAgent** | Reviews for quality and correctness | Code analysis | Quality assurance |\n\n---\n\n## Orchestration Rules\n\n### Routing Logic\n1. Analyze user request and classify intent\n2. Route to appropriate specialist agent\n3. Keep subsequent turns with same agent until topic shifts\n4. Log every routing decision for debugging\n\n### State Management\n- Maintain shared state across agent handoffs\n- Use session-specific state (keyed by session/user)\n- Checkpoint at important milestones\n- Each agent reads from and writes to shared state\n\n### Verification Layers\n- Before finalizing, invoke ReviewerAgent to validate\n- On validation failure, route back to original agent for correction\n- Maximum 3 correction attempts before escalation\n\n### Error Handling\n- On agent error: retry once, then try alternative approach\n- On timeout: abort current step, log, and escalate\n- On validation failure: route to correction flow\n- Maximum 10 steps per workflow to prevent runaway loops\n\n---\n\n## Workflow Template\n\n```yaml\nworkflow:\n  name: \"[WORKFLOW_NAME]\"\n  \n  steps:\n    - step: \"Plan\"\n      agent: PlannerAgent\n      action: \"Analyze request and create execution plan\"\n      output: execution_plan\n      \n    - step: \"Research\"\n      agent: ResearcherAgent\n      action: \"Gather required information\"\n      input: execution_plan\n      output: research_results\n      \n    - step: \"Implement\"\n      agent: CoderAgent\n      action: \"Write code according to plan\"\n      input: [execution_plan, research_results]\n      output: implementation\n      \n    - step: \"Test\"\n      agent: TesterAgent\n      action: \"Create and run tests\"\n      input: implementation\n      output: test_results\n      \n    - step: \"Review\"\n      agent: ReviewerAgent\n      action: \"Review implementation quality\"\n      input: [implementation, test_results]\n      output: review_verdict\n      \n    - step: \"Finalize\"\n      condition: \"review_verdict == 'pass'\"\n      action: \"Aggregate results and deliver\"\n      fallback: \"Route to correction flow\"\n```\n\n---\n\n## Coordination Protocol\n\n### Message Format\n```json\n{\n  \"from_agent\": \"AgentName\",\n  \"to_agent\": \"AgentName | Orchestrator\",\n  \"message_type\": \"request | response | error\",\n  \"content\": {\n    \"action\": \"what was done\",\n    \"result\": \"output data\",\n    \"status\": \"success | failure | needs_input\"\n  },\n  \"context\": {\n    \"step_number\": 1,\n    \"session_id\": \"...\",\n    \"trace_id\": \"...\"\n  }\n}\n```\n\n### Handoff Rules\n- Agent completes its task fully before handoff\n- Pass only necessary context to next agent\n- Include validation status in handoff\n- Orchestrator maintains global view\n\n---\n\n## Safety Controls\n\n- [ ] Each agent has limited, well-defined tools\n- [ ] No agent can execute high-risk actions without approval\n- [ ] Maximum step limit enforced\n- [ ] All agent actions logged for audit\n- [ ] Human escalation path defined\n\n---\n\n## Success Criteria\n- [ ] All subtasks completed successfully\n- [ ] Final output meets all requirements\n- [ ] All agent outputs validated\n- [ ] Complete audit trail maintained\n- [ ] No security violations\n\n"
analysis:
  keywords[46]: File,Coverage,Information,Definitions,Docs,Available,Complex,TesterAgent,Orchestration,Route,Template,Writes,ReviewerAgent,Implementation,OBJECTIVE,Agents,Test,Routing,Creates,Overview,OVERALL,Role,DESCRIBE,Tools,Code,Rules,Logic,This,High,Agent,Task,ResearcherAgent,Terminal,Multi,Planning,Gathers,Reviews,Keep,Validation,Breaks,Context,Analyze,CoderAgent,PlannerAgent,Quality,Scope
  patterns[0]:
  best_practices[0]:
  examples[0]: